---
title: "Pesticides_Data"
author: "Maya Spaur"
date: "11/14/2019"
output: github_document
---

This document is to:
1-Check to see if our pesticides of interest are in the dataset. 
2-Filter each dataset to the pesticides of interest. 
3-Merge all the years together. 


#FINDINGS: 
All 6 pesticides, "CHLOROTHALONIL","CHLORPYRIFOS"   "CLOTHIANIDIN", "FIPRONIL","IMIDACLOPRID",and "THIACLOPRID" have data from 2004-2016. 
Only 4 pesticides, "CHLOROTHALONIL","CHLORPYRIFOS", "FIPRONIL","IMIDACLOPRID" had data from 2002-2003.

```{r setup}
library(tidyverse)
library(viridis)
library(readxl)
library(ggplot2)
```

```{r merging, filtering, and cleaning pesticide data}
file_path = "./data/pesticides_csv/"
file_names = file_path %>% 
  list.files()

top_pesticides_df = 
  file_names %>%
  map_dfr(function(file_name){
  read_excel(paste0(file_path, file_name))
}) 

top_pesticides = top_pesticides_df %>% 
  janitor::clean_names() %>%
  filter(compound %in% c("CHLOROTHALONIL", "CLOTHIANIDIN", "CHLORPYRIFOS","FIPRONIL", "IMIDACLOPRID",      "THIACLOPRID"),
         year >= 2004) %>% 
  mutate(
    state_fips = state_fips_code,
    county_fips = county_fips_code,
    state_county_fips = paste0(state_fips, county_fips),
    epest_low_kg = round(epest_low_kg),
    epest_high_kg = round(epest_high_kg)) %>%
  select(-state_fips_code, -county_fips_code) 

write.csv(top_pesticides, "./data/top_pesticides.csv")

view(top_pesticides)
```


Counting the data - sample for 2002

```{r 2002}
pest_2002 = read_excel("./data/pesticides_csv/EPest.county.estimates.2003.xlsx") %>%
  janitor::clean_names() %>% 
  filter(compound == "CHLOROTHALONIL" | compound == "CLOTHIANIDIN"| compound == "CHLORPYRIFOS" | compound == "FIPRONIL" | compound == "IMIDACLOPRID"| compound ==  "THIACLOPRID") %>%
  group_by(compound) %>%
  summarize(n = n()) %>%
  select(compound, n)

pest_2002

```

Vizualing the data - sample plot for 2003

```{r 2003}
pest_2003 = read_excel("./data/pesticides_csv/EPest.county.estimates.2003.xlsx") %>%
  janitor::clean_names() %>% 
  filter(compound == "CHLOROTHALONIL" | compound == "CLOTHIANIDIN"| compound == "CHLORPYRIFOS" | compound == "FIPRONIL" | compound == "IMIDACLOPRID"| compound ==  "THIACLOPRID") %>%
  ggplot(aes(x = compound, fill = compound)) + geom_bar()


pest_2003


```

Counting the data for 2015

```{r 2015}
pest_2015 = read_excel("./data/pesticides_csv/EPest.county.estimates.2015.xlsx") %>%
  janitor::clean_names() %>% 
  filter(compound == "CHLOROTHALONIL" | compound == "CLOTHIANIDIN"| compound == "CHLORPYRIFOS" | compound == "FIPRONIL" | compound == "IMIDACLOPRID"| compound ==  "THIACLOPRID")  %>%
  group_by(compound) %>%
  summarize(n = n()) %>%
  select(compound, n)

pest_2015

```


