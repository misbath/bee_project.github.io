---
title: "Map Code"
output: html_document
---

```{r setup, include=FALSE}
library(plotly)
library(tidyverse)
library(ggplot2)
library(ggmap)
library(maps)
library(choroplethrMaps)
library(patchwork)

knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
theme_set(theme_bw() + theme(legend.position = "bottom"))
```

#Reading in data

```{r read in data,include=FALSE}
merged_county_data = read_csv("./data/merged_county_data.csv") %>%
  janitor::clean_names() %>%
  rename(year = year_x) %>%
  mutate(
    county = str_to_lower(county)
  )

merged_state_data = read_csv("./data/merged_state_data.csv") %>%
  janitor::clean_names() %>%
  rename(year = year_x)

```


```{r}
state.map <- map_data("state")
counties <- map_data("county")

merged_county_data_for_join =
  merged_county_data %>%
  rename(subregion = county)

county_2 <- merged_county_data_for_join %>%
  left_join(counties, "subregion")

unique(county_2$compound)


```

```{r making each pesticide data file, include=FALSE}

CHLORPYRIFOS =
  county_2 %>%
  filter(compound=="CHLORPYRIFOS")

CLOTHIANIDIN =
  county_2 %>%
  filter(compound=="CLOTHIANIDIN")

IMIDACLOPRID=
  county_2 %>%
  filter(compound=="IMIDACLOPRID")

CHLOROTHALONIL =
  county_2 %>%
  filter(compound=="CHLOROTHALONIL")

FIPRONIL =
  county_2 %>%
  filter(compound=="FIPRONIL")

THIACLOPRID =
  county_2 %>%
  filter(compound=="THIACLOPRID")

```

###COUNTY Maps

##Pesticides 

```{r building base and pesticide maps}

counties_base <- ggplot(data = counties, mapping = aes(x = long, y = lat, group = group)) + 
  coord_fixed(1.3) + 
  geom_polygon(color = "black", fill = "gray")

map_county <- counties_base + theme_nothing() + 
  geom_polygon(data = county_2, aes(fill= epest_high_kg), color = "white") + geom_polygon(color = "black", fill = NA) +
      theme_void() + labs(title= "All Pesticides, All Years, County Level Data", fill = "Estimated Pesticide Use (Kg)") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5))


CHLORPYRIFOS_map <- counties_base + theme_nothing() + 
  geom_polygon(data = CHLORPYRIFOS, aes(fill= epest_high_kg), color = "white") + geom_polygon(color = "black", fill = NA) +
      theme_void() + labs(title= "Chlorpyrifos, County Level Data", fill = "Estimated Pesticide Use (Kg)") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5))

CLOTHIANIDIN_map <- counties_base + theme_nothing() + 
  geom_polygon(data = CLOTHIANIDIN, aes(fill= epest_high_kg), color = "white") + geom_polygon(color = "black", fill = NA) +
      theme_void() + labs(title= "Clothianidin, County Level Data", fill = "Estimated Pesticide Use (Kg)") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5))

IMIDACLOPRID_map <- counties_base + theme_nothing() + 
  geom_polygon(data = IMIDACLOPRID, aes(fill= epest_high_kg), color = "white") + geom_polygon(color = "black", fill = NA) +
      theme_void() + labs(title= "Imidacloprid, County Level Data", fill = "Estimated Pesticide Use (Kg)") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5))

CHLOROTHALONIL_map <- counties_base + theme_nothing() + 
  geom_polygon(data = CHLOROTHALONIL, aes(fill= epest_high_kg), color = "white") + geom_polygon(color = "black", fill = NA) +
      theme_void() + labs(title= "Chlorothalonil, County Level Data", fill = "Estimated Pesticide Use (Kg)") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5))

FIPRONIL_map <- counties_base + theme_nothing() + 
  geom_polygon(data = FIPRONIL, aes(fill= epest_high_kg), color = "white") + geom_polygon(color = "black", fill = NA) +
      theme_void() + labs(title= "Fipronil, County Level Data", fill = "Estimated Pesticide Use (Kg)") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5))

THIACLOPRID_map <- counties_base + theme_nothing() + 
  geom_polygon(data = THIACLOPRID, aes(fill= epest_high_kg), color = "white") + geom_polygon(color = "black", fill = NA) +
      theme_void() + labs(title= "Thiacloprid, County Level Data", fill = "Estimated Pesticide Use (Kg)") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5))
```

```{r printing maps}

CHLOROTHALONIL_map 
CHLORPYRIFOS_map 
CLOTHIANIDIN_map
FIPRONIL_map
IMIDACLOPRID_map
THIACLOPRID_map

```
toggle: year, pesticide

I think the issue of missing data will be less so once we separate by years. I'm honestly not fully clear the difference between dark and light grey. 

##Bees

```{r}
map_county_bees <- counties_base + theme_nothing() + 
  geom_polygon(data = county_2, aes(fill= colony_count), color = "white") + geom_polygon(color = "black", fill = NA) +
      theme_void() + labs(title= "All Bees, All Years, County Level Data", fill = "Number of Bee Colonies") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5))

map_county_bees

```
toggle: year

### STATE MAPS All YEARS

##Bees

```{r state bees all years}
data(state.map)

state.map = 
  state.map %>%
  filter(region != "alaska", region != "hawaii")

merged_state_data = read_csv("./data/merged_state_data.csv")

merged_state_data_map =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state)

state_map_data = left_join(state.map, merged_state_data_map, by = "region")

honey_bee_colony_map = 
  ggplot(state_map_data, aes(long, lat, group = group, fill = honey_producing_colonies)) + geom_polygon(color = "black") + theme_void() + labs(title = "Honey Producing Colonies", fill = "Honey Producing Colonies") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

## Pesticides 

```{r state chlorpyrifos all years}
merged_state_data = read_csv("./data/merged_state_data.csv")

state_chlorpyrifos =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLORPYRIFOS")

state_map_chlorpyrifos = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorpyrifos_map =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorpyrifos", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorothalonil all years}
state_chlorothalonil =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLOROTHALONIL")

state_map_chlorothalonil = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorothalonil_map =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorothalonil", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state imidacloprid all years}
state_imidacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "IMIDACLOPRID")

state_map_imidacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

imidacloprid_map =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Imidacloprid", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state thiacloprid all years}
state_thiacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "THIACLOPRID")

state_map_thiacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

thiacloprid_map =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Thiacloprid", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state clothianidin all years}
state_clothianidin =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "Clothianidin")

state_map_clothianidin = left_join(state.map, state_chlorpyrifos, by = "region") 

clothianidin_map =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Clothianidin", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```


### STATE BEES BY YEAR

```{r state bees 2004}
data(state.map)

state.map = 
  state.map %>%
  filter(region != "alaska", region != "hawaii") 

merged_state_data = read_csv("./data/merged_state_data.csv")

merged_state_data_2004 =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(year.x == "2004")

state_map_data = left_join(state.map, merged_state_data_map, by = "region")

honey_bee_colony_map_2004 = 
  ggplot(state_map_data, aes(long, lat, group = group, fill = honey_producing_colonies)) + geom_polygon(color = "black") + theme_void() + labs(title = "Honey Producing Colonies 2004", fill = "Honey Producing Colonies") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state bees 2005}
data(state.map)

state.map = 
  state.map %>%
  filter(region != "alaska", region != "hawaii") 

merged_state_data = read_csv("./data/merged_state_data.csv")

merged_state_data =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(year.x == "2005")

state_map_data = left_join(state.map, merged_state_data_map, by = "region")

honey_bee_colony_map_2005 = 
  ggplot(state_map_data, aes(long, lat, group = group, fill = honey_producing_colonies)) + geom_polygon(color = "black") + theme_void() + labs(title = "Honey Producing Colonies 2005", fill = "Honey Producing Colonies") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state bees 2006}
data(state.map)

state.map = 
  state.map %>%
  filter(region != "alaska", region != "hawaii") 

merged_state_data = read_csv("./data/merged_state_data.csv")

merged_state_data =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(year.x == "2006")

state_map_data = left_join(state.map, merged_state_data_map, by = "region")

honey_bee_colony_map_2006 = 
  ggplot(state_map_data, aes(long, lat, group = group, fill = honey_producing_colonies)) + geom_polygon(color = "black") + theme_void() + labs(title = "Honey Producing Colonies 2006", fill = "Honey Producing Colonies") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state bees 2007}
data(state.map)

state.map = 
  state.map %>%
  filter(region != "alaska", region != "hawaii") 

merged_state_data = read_csv("./data/merged_state_data.csv")

merged_state_data =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(year.x == "2007")

state_map_data = left_join(state.map, merged_state_data_map, by = "region")

honey_bee_colony_map_2007 = 
  ggplot(state_map_data, aes(long, lat, group = group, fill = honey_producing_colonies)) + geom_polygon(color = "black") + theme_void() + labs(title = "Honey Producing Colonies 2007", fill = "Honey Producing Colonies") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state bees 2008}
data(state.map)

state.map = 
  state.map %>%
  filter(region != "alaska", region != "hawaii") 

merged_state_data = read_csv("./data/merged_state_data.csv")

merged_state_data =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(year.x == "2008")

state_map_data = left_join(state.map, merged_state_data_map, by = "region")

honey_bee_colony_map_2008 = 
  ggplot(state_map_data, aes(long, lat, group = group, fill = honey_producing_colonies)) + geom_polygon(color = "black") + theme_void() + labs(title = "Honey Producing Colonies 2008", fill = "Honey Producing Colonies") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state bees 2009}
data(state.map)

state.map = 
  state.map %>%
  filter(region != "alaska", region != "hawaii") 

merged_state_data = read_csv("./data/merged_state_data.csv")

merged_state_data =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(year.x == "2009")

state_map_data = left_join(state.map, merged_state_data_map, by = "region")

honey_bee_colony_map_2009 = 
  ggplot(state_map_data, aes(long, lat, group = group, fill = honey_producing_colonies)) + geom_polygon(color = "black") + theme_void() + labs(title = "Honey Producing Colonies 2009", fill = "Honey Producing Colonies") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")


```

```{r state bees 2010}
data(state.map)

state.map = 
  state.map %>%
  filter(region != "alaska", region != "hawaii") 

merged_state_data = read_csv("./data/merged_state_data.csv")

merged_state_data =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(year.x == "2010")

state_map_data = left_join(state.map, merged_state_data_map, by = "region")

honey_bee_colony_map_2010 = 
  ggplot(state_map_data, aes(long, lat, group = group, fill = honey_producing_colonies)) + geom_polygon(color = "black") + theme_void() + labs(title = "Honey Producing Colonies 2010", fill = "Honey Producing Colonies") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state bees 2011}
data(state.map)

state.map = 
  state.map %>%
  filter(region != "alaska", region != "hawaii") 

merged_state_data = read_csv("./data/merged_state_data.csv")

merged_state_data =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(year.x == "2011")

state_map_data = left_join(state.map, merged_state_data_map, by = "region")

honey_bee_colony_map_2011 = 
  ggplot(state_map_data, aes(long, lat, group = group, fill = honey_producing_colonies)) + geom_polygon(color = "black") + theme_void() + labs(title = "Honey Producing Colonies 2011", fill = "Honey Producing Colonies") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state bees 2012}
data(state.map)

state.map = 
  state.map %>%
  filter(region != "alaska", region != "hawaii") 

merged_state_data = read_csv("./data/merged_state_data.csv")

merged_state_data =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(year.x == "2012")

state_map_data = left_join(state.map, merged_state_data_map, by = "region")

honey_bee_colony_map_2012 = 
  ggplot(state_map_data, aes(long, lat, group = group, fill = honey_producing_colonies)) + geom_polygon(color = "black") + theme_void() + labs(title = "Honey Producing Colonies 2012", fill = "Honey Producing Colonies") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")


```

```{r state bees 2013}
data(state.map)

state.map = 
  state.map %>%
  filter(region != "alaska", region != "hawaii") 

merged_state_data = read_csv("./data/merged_state_data.csv")

merged_state_data =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(year.x == "2013")

state_map_data = left_join(state.map, merged_state_data_map, by = "region")

honey_bee_colony_map_2013 = 
  ggplot(state_map_data, aes(long, lat, group = group, fill = honey_producing_colonies)) + geom_polygon(color = "black") + theme_void() + labs(title = "Honey Producing Colonies 2013", fill = "Honey Producing Colonies") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state bees 2014}
data(state.map)

state.map = 
  state.map %>%
  filter(region != "alaska", region != "hawaii") 

merged_state_data = read_csv("./data/merged_state_data.csv")

merged_state_data =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(year.x == "2014")

state_map_data = left_join(state.map, merged_state_data_map, by = "region")

honey_bee_colony_map_2014 = 
  ggplot(state_map_data, aes(long, lat, group = group, fill = honey_producing_colonies)) + geom_polygon(color = "black") + theme_void() + labs(title = "Honey Producing Colonies 2014", fill = "Honey Producing Colonies") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state bees 2015}
data(state.map)

state.map = 
  state.map %>%
  filter(region != "alaska", region != "hawaii") 

merged_state_data = read_csv("./data/merged_state_data.csv")

merged_state_data =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(year.x == "2015")

state_map_data = left_join(state.map, merged_state_data_map, by = "region")

honey_bee_colony_map_2015 = 
  ggplot(state_map_data, aes(long, lat, group = group, fill = honey_producing_colonies)) + geom_polygon(color = "black") + theme_void() + labs(title = "Honey Producing Colonies 2015", fill = "Honey Producing Colonies") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state bees 2016}
data(state.map)

state.map = 
  state.map %>%
  filter(region != "alaska", region != "hawaii") 

merged_state_data = read_csv("./data/merged_state_data.csv")

merged_state_data =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(year.x == "2016")

state_map_data = left_join(state.map, merged_state_data_map, by = "region")

honey_bee_colony_map_2016 = 
  ggplot(state_map_data, aes(long, lat, group = group, fill = honey_producing_colonies)) + geom_polygon(color = "black") + theme_void() + labs(title = "Honey Producing Colonies 2016", fill = "Honey Producing Colonies") + coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```



### Chlorpyrifos by Year

```{r state chlorpyrifos 2004}
state_chlorpyrifos =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLORPYRIFOS" & year.x == "2004")

state_map_chlorpyrifos = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorpyrifos_map_2004 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorpyrifos Use 2004", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorpyrifos 2005}
state_chlorpyrifos =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLORPYRIFOS" & year.x == "2005")

state_map_chlorpyrifos = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorpyrifos_map_2004 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorpyrifos Use 2005", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorpyrifos 2006}
state_chlorpyrifos =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLORPYRIFOS" & year.x == "2006")

state_map_chlorpyrifos = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorpyrifos_map_2004 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorpyrifos Use 2006", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorpyrifos 2007}
state_chlorpyrifos =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLORPYRIFOS" & year.x == "2007")

state_map_chlorpyrifos = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorpyrifos_map_2004 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorpyrifos Use 2007", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorpyrifos 2008}
state_chlorpyrifos =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLORPYRIFOS" & year.x == "2004")

state_map_chlorpyrifos = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorpyrifos_map_2008 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorpyrifos Use 2008", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorpyrifos 2009}
state_chlorpyrifos =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLORPYRIFOS" & year.x == "2009")

state_map_chlorpyrifos = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorpyrifos_map_2004 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorpyrifos Use 2009", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorpyrifos 2010}
state_chlorpyrifos =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLORPYRIFOS" & year.x == "2010")

state_map_chlorpyrifos = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorpyrifos_map_2010 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorpyrifos Use 2010", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorpyrifos 2011}
state_chlorpyrifos =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLORPYRIFOS" & year.x == "2011")

state_map_chlorpyrifos = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorpyrifos_map_2011 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorpyrifos Use 2011", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorpyrifos 2012}
state_chlorpyrifos =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLORPYRIFOS" & year.x == "2012")

state_map_chlorpyrifos = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorpyrifos_map_2012 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorpyrifos Use 2012", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorpyrifos 2013}
state_chlorpyrifos =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLORPYRIFOS" & year.x == "2013")

state_map_chlorpyrifos = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorpyrifos_map_2013 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorpyrifos Use 2013", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorpyrifos 2014}
state_chlorpyrifos =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLORPYRIFOS" & year.x == "2014")

state_map_chlorpyrifos = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorpyrifos_map_2014 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorpyrifos Use 2014", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorpyrifos 2015}
state_chlorpyrifos =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLORPYRIFOS" & year.x == "2015")

state_map_chlorpyrifos = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorpyrifos_map_2015 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorpyrifos Use 2015", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorpyrifos 2016}
state_chlorpyrifos =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLORPYRIFOS" & year.x == "2016")

state_map_chlorpyrifos = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorpyrifos_map_2016 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorpyrifos Use 2016", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```
 
### Chloranthalonil by Year

```{r state chlorothalonil 2004}
state_chlorothalonil =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLOROTHALONIL" & year.x == "2004")

state_map_chlorothalonil = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorothalonil_map_2004 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorothalonil Use 2004", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorothalonil 2005}
state_chlorothalonil =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLOROTHALONIL" & year.x == "2005")

state_map_chlorothalonil = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorothalonil_map_2005 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorothalonil Use 2005", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorothalonil 2006}
state_chlorothalonil =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLOROTHALONIL" & year.x == "2006")

state_map_chlorothalonil = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorothalonil_map_2006 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorothalonil Use 2006", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorothalonil 2007}
state_chlorothalonil =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLOROTHALONIL" & year.x == "2007")

state_map_chlorothalonil = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorothalonil_map_2007 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorothalonil Use 2007", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorothalonil 2008}
state_chlorothalonil =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLOROTHALONIL" & year.x == "2008")

state_map_chlorothalonil = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorothalonil_map_2008 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorothalonil Use 2008", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorothalonil 2009}
state_chlorothalonil =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLOROTHALONIL" & year.x == "2009")

state_map_chlorothalonil = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorothalonil_map_2009 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorothalonil Use 2009", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorothalonil 2010}
state_chlorothalonil =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLOROTHALONIL" & year.x == "2010")

state_map_chlorothalonil = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorothalonil_map_2010 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorothalonil Use 2010", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorothalonil 2011}
state_chlorothalonil =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLOROTHALONIL" & year.x == "2011")

state_map_chlorothalonil = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorothalonil_map_2011 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorothalonil Use 2011", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorothalonil 2012}
state_chlorothalonil =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLOROTHALONIL" & year.x == "2012")

state_map_chlorothalonil = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorothalonil_map_2012 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorothalonil Use 2012", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorothalonil 2013}
state_chlorothalonil =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLOROTHALONIL" & year.x == "2013")

state_map_chlorothalonil = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorothalonil_map_2013 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorothalonil Use 2013", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorothalonil 2014}
state_chlorothalonil =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLOROTHALONIL" & year.x == "2014")

state_map_chlorothalonil = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorothalonil_map_2014 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorothalonil Use 2014", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorothalonil 2015}
state_chlorothalonil =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLOROTHALONIL" & year.x == "2015")

state_map_chlorothalonil = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorothalonil_map_2015 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorothalonil Use 2015", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state chlorothalonil 2016}
state_chlorothalonil =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "CHLOROTHALONIL" & year.x == "2016")

state_map_chlorothalonil = left_join(state.map, state_chlorpyrifos, by = "region") 

chlorothalonil_map_2016 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Chlorothalonil Use 20116", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

### Imidacloprid By Year 

```{r state imidacloprid 2004}
state_imidacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "IMIDACLOPRID" & year.x == "2004")

state_map_imidacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

imidacloprid_map_2004 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Imidacloprid Use 2004", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state imidacloprid 2005}
state_imidacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "IMIDACLOPRID" & year.x == "2005")

state_map_imidacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

imidacloprid_map_2005 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Imidacloprid Use 2005", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state imidacloprid 2006}
state_imidacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "IMIDACLOPRID" & year.x == "2006")

state_map_imidacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

imidacloprid_map_2006 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Imidacloprid Use 2006", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state imidacloprid 2007}
state_imidacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "IMIDACLOPRID" & year.x == "2007")

state_map_imidacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

imidacloprid_map_2007 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Imidacloprid Use 2007", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state imidacloprid 2008}
state_imidacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "IMIDACLOPRID" & year.x == "2008")

state_map_imidacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

imidacloprid_map_2008 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Imidacloprid Use 2008", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state imidacloprid 2009}
state_imidacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "IMIDACLOPRID" & year.x == "2009")

state_map_imidacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

imidacloprid_map_2009 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Imidacloprid Use 2009", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state imidacloprid 2010}
state_imidacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "IMIDACLOPRID" & year.x == "2010")

state_map_imidacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

imidacloprid_map_2010 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Imidacloprid Use 2010", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state imidacloprid 2011}
state_imidacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "IMIDACLOPRID" & year.x == "2011")

state_map_imidacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

imidacloprid_map_2011 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Imidacloprid Use 2011", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state imidacloprid 2012}
state_imidacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "IMIDACLOPRID" & year.x == "2012")

state_map_imidacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

imidacloprid_map_2012 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Imidacloprid Use 2012", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state imidacloprid 2013}
state_imidacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "IMIDACLOPRID" & year.x == "2013")

state_map_imidacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

imidacloprid_map_2013 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Imidacloprid Use 2013", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state imidacloprid 2014}
state_imidacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "IMIDACLOPRID" & year.x == "2014")

state_map_imidacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

imidacloprid_map_2014 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Imidacloprid Use 2014", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state imidacloprid 2015}
state_imidacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "IMIDACLOPRID" & year.x == "2015")

state_map_imidacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

imidacloprid_map_2015 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Imidacloprid Use 2015", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state imidacloprid 2016}
state_imidacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "IMIDACLOPRID" & year.x == "2016")

state_map_imidacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

imidacloprid_map_2016 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Imidacloprid Use 2016", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

### Thiacloprid by Year

```{r state thiacloprid 2004}
state_thiacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "THIACLOPRID" & year.x == "2004")

state_map_thiacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

thiacloprid_map_2004 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Thiacloprid Use 2004", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state thiacloprid 2005}
state_thiacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "THIACLOPRID" & year.x == "2005")

state_map_thiacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

thiacloprid_map_2005 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Thiacloprid Use 2005", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state thiacloprid 2006}
state_thiacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "THIACLOPRID" & year.x == "2006")

state_map_thiacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

thiacloprid_map_2006 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Thiacloprid Use 2006", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state thiacloprid 2007}
state_thiacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "THIACLOPRID" & year.x == "2007")

state_map_thiacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

thiacloprid_map_2007 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Thiacloprid Use 2007", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state thiacloprid 2008}
state_thiacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "THIACLOPRID" & year.x == "2008")

state_map_thiacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

thiacloprid_map_2008 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Thiacloprid Use 2008", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state thiacloprid 2009}
state_thiacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "THIACLOPRID" & year.x == "2009")

state_map_thiacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

thiacloprid_map_2009 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Thiacloprid Use 2009", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state thiacloprid 2010}
state_thiacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "THIACLOPRID" & year.x == "2010")

state_map_thiacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

thiacloprid_map_2010 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Thiacloprid Use 2010", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state thiacloprid 2011}
state_thiacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "THIACLOPRID" & year.x == "2011")

state_map_thiacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

thiacloprid_map_2011 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Thiacloprid Use 2011", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state thiacloprid 2012}
state_thiacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "THIACLOPRID" & year.x == "2012")

state_map_thiacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

thiacloprid_map_2012 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Thiacloprid Use 2012", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state thiacloprid 2013}
state_thiacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "THIACLOPRID" & year.x == "2013")

state_map_thiacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

thiacloprid_map_2013 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Thiacloprid Use 2013", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state thiacloprid 2014}
state_thiacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "THIACLOPRID" & year.x == "2014")

state_map_thiacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

thiacloprid_map_2014 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Thiacloprid Use 2014", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state thiacloprid 2015}
state_thiacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "THIACLOPRID" & year.x == "2015")

state_map_thiacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

thiacloprid_map_2015 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Thiacloprid Use 2015", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state thiacloprid 2016}
state_thiacloprid =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "THIACLOPRID" & year.x == "2016")

state_map_thiacloprid = left_join(state.map, state_chlorpyrifos, by = "region") 

thiacloprid_map_2016 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Thiacloprid Use 2016", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

## Clothianidin By Year 

```{r state clothianidin 2004}
state_clothianidin =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "Clothianidin" & year.x == "2004")

state_map_clothianidin = left_join(state.map, state_chlorpyrifos, by = "region") 

clothianidin_map_2004 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Clothianidin Use 2004", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state clothianidin 2005}
state_clothianidin =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "Clothianidin" & year.x == "2005")

state_map_clothianidin = left_join(state.map, state_chlorpyrifos, by = "region") 

clothianidin_map_2005 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Clothianidin Use 2005", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state clothianidin 2006}
state_clothianidin =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "Clothianidin" & year.x == "2006")

state_map_clothianidin = left_join(state.map, state_chlorpyrifos, by = "region") 

clothianidin_map_2006 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Clothianidin Use 2006", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state clothianidin 2007}
state_clothianidin =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "Clothianidin" & year.x == "2007")

state_map_clothianidin = left_join(state.map, state_chlorpyrifos, by = "region") 

clothianidin_map_2007 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Clothianidin Use 2007", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state clothianidin 2008}
state_clothianidin =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "Clothianidin" & year.x == "2008")

state_map_clothianidin = left_join(state.map, state_chlorpyrifos, by = "region") 

clothianidin_map_2008 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Clothianidin Use 2008", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state clothianidin 2009}
state_clothianidin =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "Clothianidin" & year.x == "2009")

state_map_clothianidin = left_join(state.map, state_chlorpyrifos, by = "region") 

clothianidin_map_2009 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Clothianidin Use 2009", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state clothianidin 2010}
state_clothianidin =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "Clothianidin" & year.x == "2010")

state_map_clothianidin = left_join(state.map, state_chlorpyrifos, by = "region") 

clothianidin_map_2010 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Clothianidin Use 2010", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state clothianidin 2011}
state_clothianidin =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "Clothianidin" & year.x == "2011")

state_map_clothianidin = left_join(state.map, state_chlorpyrifos, by = "region") 

clothianidin_map_2011 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Clothianidin Use 2011", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state clothianidin 2012}
state_clothianidin =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "Clothianidin" & year.x == "2012")

state_map_clothianidin = left_join(state.map, state_chlorpyrifos, by = "region") 

clothianidin_map_2012 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Clothianidin Use 2012", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state clothianidin 2013}
state_clothianidin =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "Clothianidin" & year.x == "2013")

state_map_clothianidin = left_join(state.map, state_chlorpyrifos, by = "region") 

clothianidin_map_2013 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Clothianidin Use 2013", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state clothianidin 2014}
state_clothianidin =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "Clothianidin" & year.x == "2014")

state_map_clothianidin = left_join(state.map, state_chlorpyrifos, by = "region") 

clothianidin_map_2014 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Clothianidin Use 2014", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state clothianidin 2015}
state_clothianidin =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "Clothianidin" & year.x == "2015")

state_map_clothianidin = left_join(state.map, state_chlorpyrifos, by = "region") 

clothianidin_map_2015 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Clothianidin Use 2015", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

```{r state clothianidin 2016}
state_clothianidin =
  merged_state_data %>%
  mutate(state = str_to_lower(state)) %>%
  rename(region = state) %>%
  filter(compound == "Clothianidin" & year.x == "2016")

state_map_clothianidin = left_join(state.map, state_chlorpyrifos, by = "region") 

clothianidin_map_2016 =
  ggplot(state_map_chlorpyrifos, aes(long, lat, group = group, fill = high)) + geom_polygon(color = "black") + theme_void() + labs(title = "Clothianidin Use 2016", fill = "Estimated Pesticide Use (Kg)") +  coord_map(projection = "bonne", lat0 = 50) + theme(plot.title = element_text(hjust = 0.5)) + scale_fill_gradient(low = "white", high = "red")

```

