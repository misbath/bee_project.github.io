---
title: "Pesticide Change Over the Years"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
runtime: shiny
---

```{r setup, include=FALSE}
library(flexdashboard)
library(shiny)
library(plotly)
library(tidyverse)
library(ggplot2)
library(ggmap)
library(maps)
library(mapdata)

```


#Reading in data

```{r read in data,include=FALSE}
merged_county_data = read_csv("./data/merged_county_data.csv") %>%
  janitor::clean_names() %>%
  rename(year = year_x)


merged_state_data = read_csv("./data/merged_state_data.csv") %>%
  janitor::clean_names() %>%
  rename(year = year_x)

```

#Reading in other data

```{r, include = FALSE}
pesticides = read_csv("./data/top_pesticides.csv") %>% 
  select(-epest_low_kg)

fips_codes = read_csv("./data/fips_codes.csv")

```


```{r}

usa <- map_data("state")
head(usa)
view(usa)
counties <- map_data("county")
counties

head(counties)
head(pesticides)

merged_state_data_for_join = 
  merged_state_data %>%
  rename(region = state)

head(merged_state_data)
```

```{r}
usa_2 <- merged_state_data_for_join %>%
            left_join(usa, "region")

head(usa_2)
```




Column {.sidebar}
-----------------------------------------------------------------------

###County Data 

```{r}

```

Column {data-width=650}
-----------------------------------------------------------------------

### Chart A

```{r, eval = FALSE}


  
```

Column {.sidebar}
-----------------------------------------------------------------------

###State Data

```{r, eval = FALSE}
usa_base <- ggplot(data = usa, mapping = aes(x = long, y = lat, group = group)) + 
  coord_fixed(1.3) + 
  geom_polygon(color = "black", fill = "gray")

map <- usa_base + theme_nothing() + 
  geom_polygon(data = usa_2, aes(fill= high), color = "white") + geom_polygon(color = "black", fill = NA) +
      theme_bw()

map
view(usa_2)
```

Column {data-width=350}
-----------------------------------------------------------------------

### Chart B

```{r, eval = FALSE}


library(maps)
map('state')
map('county')
cnty.fips <- county.fips$fips[match(map("county", plot=FALSE)$names,
    county.fips$polyname)]

data("merged_county_data")
#merged_county_data %>%
  map("state", xlim = range(epest_high_kg$x), ylim = range(epest_high_kg$y))

```

### Chart C

```{r}

```
